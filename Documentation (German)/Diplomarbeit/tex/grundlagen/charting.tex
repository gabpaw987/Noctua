\lstset{style=sharpc}
\subsection{Microsoft Chart Controls} \label{charting}

Die Microsoft Charts Controls Library ist eine sehr umfangreiche Bibliothek, die es ermöglicht, in WinForms-Anwendungen oder auf Webseiten mit ASP.NET Charts und Diagramme zu zeichnen. Die Möglichkeiten sind dermaßen umfangreich, dass es im Folgenden nur Sinn macht, die Funktionen zu erläutern, die für die Darstellung finanzieller Charts erheblich sind. Zu den Hauptfeatures zählen daher \cite{msdn-charting}:

\begin{itemize}
\item \textbf{Charttypen} \\
	Es werden 35 verschiedene Charttypen unterstützt. Das Spektrum reicht von normalen Liniencharts bis zu Bar- und Candlestick-Charts zur Darstellung von Aktiendaten.
\item \textbf{Skalierbarkeit} \\
	Es können nahezu unendlich viele Daten, Chart-Areas (Bereiche innerhalb eines Charts), Bemerkungen (z.B. Pfeile), etc. innerhalb eines Charts angezeigt werden. Daher können bspw. Aktiendaten und deren \glspl{ma} in einer \inline{ChartArea} angezeigt werden. Zusätzlich könnte man eine weitere \inline{ChartArea} ergänzen, um bspw. einen \gls{macd}-Verlauf direkt unter den Aktiendaten zu zeichnen.
\item \textbf{Daten} \\
	Es werden Unmengen an Möglichkeiten zur Verwaltung der Daten innerhalb eines Charts, wie z.B. Data Binding, zur Verfügung gestellt. Außerdem können die Daten des Charts exportiert oder zum Speichern serialisiert werden. 
\item \textbf{Aussehen} \\
	Weiters können sowohl zweidimensionale als auch dreidimensionale Charts erstellt werden, die alle sehr simpel und schön dargestellt werden. Sie können zudem auch zur Laufzeit noch weiter manipuliert werden und die Win\-Forms-Version bietet sogar Möglichkeiten zum interaktiven Zoomen und Scrollen für den User. (Auf Webseiten mit ASP.NET werden keine interaktiven Funktionen für den Benutzer der Website angeboten.) 
\end{itemize} \cite{msdn-charting}

\subsubsection{Nutzung mit WPF} \label{winformshost}

Leider ist momentan noch keine Version für die Verwendung mit \gls{wpf} erhältlich. Man kann diese Einschränkung allerdings umgehen indem man einen sog. \inline{WinFormsHost} erstellt. Dies ist ein \gls{wpf}-\gls{gui}-Element, das WinForms-Elemente so kapselt, dass sie in \gls{wpf} genutzt werden können. Dieses Element mit einem \inline{MSChart} kann so erstellt werden:

\begin{lstlisting}[label=MSChart in einer WinFormsHost-Umgebung,caption=MSChart in einer WinFormsHost-Umgebung]
<WindowsFormsHost Name="WfHost" Grid.Row="0">
	<MSChart:Chart x:Name="MyWinformChart">
		<MSChart:Chart.ChartAreas>
			<MSChart:ChartArea Name="MainArea"/>
		</MSChart:Chart.ChartAreas>
	</MSChart:Chart>
</WindowsFormsHost>
\end{lstlisting}

Hier wurde außer dem primitiven \inline{MSChart} auch gleich eine \inline{ChartArea} hinzugefügt. Eine \inline{ChartArea} ist ein Bereich innerhalb des Charts (hier der gesamte Bereich des Charts), in dem eine Funktion gezeichnet werden kann. Damit dieses \inline{WinFormsHost}-Element allerdings funktioniert, müssen für das gesamte \inline{Window} noch folgende Namespaces ergänzt werden (diese Assemblies müssen natürlich auch als Verweis zum Projekt hinzugefügt werden):

\begin{lstlisting}[label=Namespaces für MSChart und WinFormsHost,caption=Namespaces für MSChart und WinFormsHost]
xmlns:wf="clr-namespace:System.Windows.Forms;
	assembly=System.Windows.Forms"
xmlns:MSChart="clr-namespace:
	System.Windows.Forms.DataVisualization.Charting;
	assembly=System.Windows.Forms.DataVisualization"
xmlns:wfi="clr-namespace:System.Windows.Forms.Integration;
	assembly=WindowsFormsIntegration"
\end{lstlisting}

\subsubsection{Darstellung einfacher Graphen}

Nachdem eine leere \inline{ChartArea}, in die ein Graph gezeichnet werden kann, bereits im \gls{xaml} erzeugt wurde, muss man im C\#-Code nur noch das \inline{Chart} suchen, in das gezeichnet werden soll und eine \inline{Series} erstellen. In diese Series werden dann die Daten eingespeist, die gezeichnet werden sollen. Wenn man nun auch noch einen Typ für den Graphen konfiguriert, wird dieser auch schon in der \inline{ChartArea} angezeigt. Um bspw. eine Sinusfunktion darzustellen, müsste man nun folgenden Code schreiben: \cite{msdn-charting}

\begin{lstlisting}[label=Erstellung einer Series,caption=Erstellung einer Series]
//Lookup des bereits im XAMl-Code definierten Charts
Chart chart = this.FindName("MyWinformChart") as Chart;

//Erstellen der Series
Series sinus = new Series("Sinus");

//Berechnung einer Sinuskurve und speichern der
//errechneten Daten in die Series
for (double i = 0; i <= 7.5; i += 0.2)
	sinus.Points.AddXY(i, Math.Sin(i));

//Definieren des Zeichentyps als normale Linie
sinus.ChartType = SeriesChartType.FastLine;
 
// Hinzufuegen des Graphs zum Chart
chart.Series.Add(sinus);
\end{lstlisting} \cite{mschart-grundlagen}

In diesem Beispiel wurde jeder Punkt des Sinus einzeln berechnet und zur \inline{Series} hinzugefügt. Dies könnte man natürlich auch mit jeder anderen Datenquelle wie zum Beispiel einer Liste machen, in dem man jeden Wert einzeln hinzufügt. \cite{msdn-charting}

\subsubsection{Finanzielle Berechnungen} \label{finfor}

Die Microsoft Chart Controls Library bietet allerdings nicht nur Möglichkeiten zur einfachen Darstellung von Daten. Denn sie beinhaltet ein Framework aus über 50 verschiedenen statistischen und finanziellen Formeln zur automatischen Berechnung und Darstellung spezieller Werte. \cite{msdn-charting}\\
\\
Die wichtigsten Formeln in der \inline{FinancialFormula}-Sammlung der MS Chart Controls sind:

\begin{itemize}
\item Bollinger Bänder
\item \gls{cci}
\item diverse \glspl{ma}
\item \gls{macd}
\end{itemize} \cite{msdn-charting}

Im Code würde der Einsatz von \inline{FinancialFormula} so aussehen:

\begin{lstlisting} [label=Berechnung eines MA mit FinancialFormula,caption=Berechnung eines MA mit FinancialFormula]
chart.DataManipulator.FinancialFormula(
	FinancialFormula.MovingAverage, 90, "Data", "FinFor");
\end{lstlisting} \cite{msdn-charting}

Dieser Aufruf erzeugt einen \gls{ma} der Länge 90. Dazu holt er sich die Daten aus der Series "`\inline{Data}"', berechnet den \gls{ma} und schreibt die errechneten Daten in die \inline{Series FinFor}. Damit diese Berechnung möglich ist, müss die \inline{Series} \inline{FinFor} und die \inline{Series} \inline{Data} bereits zuvor erzeugt und auch wirklich mit Daten gefüllt sein. \cite{msdn-charting}